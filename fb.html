<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>FB Video Downloader</title>
<style>
body { font-family: Arial; padding: 20px; background: #fafafa; }
input { width: 100%; padding: 10px; margin-top: 10px; }
button { padding: 10px; width: 100%; margin-top: 10px; }
#result { margin-top: 20px; }
</style>
</head>
<body>

<h2>Facebook Video Downloader (réel)</h2>

<input id="videoUrl" placeholder="Colle le lien Facebook">
<button onclick="download()">Extraire</button>

<div id="result"></div>

<script>
async function download() {
    const url = document.getElementById('videoUrl').value.trim();
    if (!url) return alert("Colle l'URL");

    document.getElementById("result").innerHTML = "⏳ Extraction...";

    const proxy = "https://cors-anywhere.herokuapp.com/";

    try {
        const req = await fetch(proxy + url);
        const html = await req.text();

        const match = html.match(/"playable_url":"(https:[^"]+)"/);

        if (!match) {
            document.getElementById("result").innerHTML =
                "<b>Impossible d'extraire la vidéo. Vérifie que la vidéo est publique.</b>";
            return;
        }

        const videoLink = match[1].replace(/\\/g, "");

        document.getElementById("result").innerHTML = `
            <p>✔️ Vidéo trouvée</p>
            <video controls width="100%" src="${videoLink}"></video>
            <br><br>
            <a href="${videoLink}" download="fb_video.mp4"
               style="padding:10px; background:#3498db; color:white; text-decoration:none;">
               Télécharger la vidéo
            </a>
        `;
    }
    catch(e) {
        document.getElementById("result").innerHTML =
            "<b>Erreur : le serveur source bloque (Facebook protège certaines vidéos).</b>";
    }
}
</script>

</body>
</html>