<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>Robot MaxGram Semi-Auto</title>
<style>
body{font-family:Arial,sans-serif;max-width:900px;margin:20px auto;padding:10px;}
button{padding:10px 12px;background:#27ae60;color:#fff;border:none;cursor:pointer;margin-top:5px;}
#log{height:200px;border:1px solid #ccc;padding:6px;overflow:auto;background:#f9f9f9;margin-top:10px;}
iframe{width:100%;height:420px;border:1px solid #999;margin-top:10px;}
.err{color:#c0392b;font-weight:bold;}
.ok{color:#16a085;font-weight:bold;}
</style>
</head>
<body>

<h2>Robot MaxGram (Semi-Automatique)</h2>
<div>
  <button id="runScriptBtn">Ex√©cuter script de publication</button>
</div>

<div id="log"></div>

<iframe id="maxgramFrame" src="https://maxgram.wapaxo.com/?u=Thibaut&p=64932261"></iframe>

<script>
const logEl = document.getElementById('log');
function appendLog(txt, cls){
  const p = document.createElement('div');
  if(cls) p.className = cls;
  p.textContent = (new Date()).toLocaleTimeString() + ' ‚Äî ' + txt;
  logEl.appendChild(p);
  logEl.scrollTop = logEl.scrollHeight;
}

// Posts √† publier
const posts = [
  { text: "Post automatique n¬∞1 üöÄ", image: "" },
  { text: "Post automatique n¬∞2 üñºÔ∏è", image: "https://via.placeholder.com/300" },
  { text: "Post automatique n¬∞3 üéØ", image: "" }
];

document.getElementById('runScriptBtn').addEventListener('click', () => {
  appendLog('üîπ Pour que le script fonctionne, ouvrez la console de l\'iframe MaxGram et collez le script suivant :', 'ok');
  appendLog('--- SCRIPT √Ä COLLER DANS LA CONSOLE DE L\'IFRAME MAXGRAM ---', 'ok');

  const userScript = `
(function(){
  const posts = ${JSON.stringify(posts)};
  const delay = 3000;

  async function runPosts(){
    const textarea = document.querySelector('textarea[name="text"]');
    const imgInput = document.querySelector('input[name="var-img"]');
    const submitBtn = document.querySelector('button[name="blog_submit"]');

    if(!textarea || !submitBtn){
      console.error("‚ùå Formulaire introuvable !");
      return;
    }

    for(let i=0;i<posts.length;i++){
      const p = posts[i];
      console.log("üìå Publication "+(i+1)+": "+p.text);
      textarea.value = p.text;
      if(imgInput) imgInput.value = p.image || "";
      submitBtn.click();
      await new Promise(res=>setTimeout(res, delay));
    }

    console.log("‚úÖ Tous les posts ont √©t√© publi√©s !");
  }

  runPosts();
})();
  `;

  console.log(userScript);
  appendLog('üìå Copiez-collez ce script dans la console de l\'iframe MaxGram pour publier automatiquement.', 'ok');
});
</script>

</body>
</html>